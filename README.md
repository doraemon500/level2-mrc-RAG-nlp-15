<div align='center'>

  # ğŸ† LV.2 NLP í”„ë¡œì íŠ¸ : Open-Domain Question Answering

</div>

## âœï¸ ëŒ€íšŒ ì†Œê°œ

| íŠ¹ì§•     | ì„¤ëª… |
|:------:| --- |
| ëŒ€íšŒ ì£¼ì œ | ë„¤ì´ë²„ ë¶€ìŠ¤íŠ¸ìº í”„ AI Tech 7ê¸° NLP Trackì˜ Level 2 ë„ë©”ì¸ ê¸°ì´ˆ ëŒ€íšŒ 'Open-Domain Question Answering (Machine Reading Comprehension)'ì…ë‹ˆë‹¤. |
| ëŒ€íšŒ ì„¤ëª… | ì£¼ì–´ì§€ëŠ” Documentsì˜ ë‚´ìš©ì„ ê¸°ë°˜ìœ¼ë¡œ ì§ˆë¬¸ì´ ì£¼ì–´ì§€ë©´, ê·¸ ì§ˆë¬¸ì— ëŒ€í•œ ì •í™•í•œ ë‹µë³€ì„ ë¬¸ì„œì—ì„œ ì°¾ì•„ë‚´ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. |
| ë°ì´í„° êµ¬ì„± | ë°ì´í„°ëŠ” ìœ„í‚¤í”¼ë””ì•„ì˜ ë‚´ìš©ìœ¼ë¡œ ëŒ€ë¶€ë¶„ ì´ë£¨ì–´ì§„ ë¬¸ì„œ ë°ì´í„°, ê·¸ë¦¬ê³  Questionê³¼ Answerë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. |
| í‰ê°€ ì§€í‘œ | ë‹µë³€ì„ ì •í™•íˆ ì¶”ì¶œí•˜ëŠ”ì§€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ EM(Exact Match) ì§€í‘œê°€ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.|


## ğŸ–ï¸ Leader Board
í”„ë¡œì íŠ¸ ê²°ê³¼ Public ë¦¬ë”ë³´ë“œ 2ë“±, Private ë¦¬ë”ë³´ë“œ 2ë“± (ê³µë™ EM Score)ì„ ê¸°ë¡í•˜ì˜€ìŠµë‹ˆë‹¤.
###  Public Leader Board 
![leaderboard_mid](./docs/leaderboard_mid.png)

###  Private Leader Board 
![leaderboard_final](./docs/leaderboard_final.png)

## ğŸ‘¨â€ğŸ’» 15ì¡°ê°€ì‹­ì˜¤ì¡° ë©¤ë²„
<div align='center'>
  
| ê¹€ì§„ì¬ [<img src="./docs/github_official_logo.png" width=20 style="vertical-align:middle;" />](https://github.com/jin-jae) | ë°•ê·œíƒœ [<img src="./docs/github_official_logo.png" width=20 style="vertical-align:middle;" />](https://github.com/doraemon500) | ìœ¤ì„ ì›… [<img src="./docs/github_official_logo.png" width=20 style="vertical-align:middle;" />](https://github.com/ssunbear) | ì´ì •ë¯¼ [<img src="./docs/github_official_logo.png" width=20 style="vertical-align:middle;" />](https://github.com/simigami) | ì„í•œíƒ [<img src="./docs/github_official_logo.png" width=20 style="vertical-align:middle;" />](https://github.com/LHANTAEK)
|:-:|:-:|:-:|:-:|:-:|
| ![ê¹€ì§„ì¬](https://avatars.githubusercontent.com/u/97018331) | ![ë°•ê·œíƒœ](https://avatars.githubusercontent.com/u/64678476) | ![ìœ¤ì„ ì›…](https://avatars.githubusercontent.com/u/117508164) | ![ì´ì •ë¯¼](https://avatars.githubusercontent.com/u/46891822) | ![ì„í•œíƒ](https://avatars.githubusercontent.com/u/143519383) |

</div>

  
## ğŸ‘¼ ì—­í•  ë¶„ë‹´
<div align='center'>

|íŒ€ì›   | ì—­í•  |
|------| --- |
| ê¹€ì§„ì¬ | ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œ ì‘ì„±, ì¡°ì‚¬ ì „ì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ ê°œë°œ, ì•™ìƒë¸” |
| ë°•ê·œíƒœ | ë°ì´í„° íŠ¹ì„± ë¶„ì„, EDA, Retrieval êµ¬í˜„, ë¹„êµ ì‹¤í—˜ ë° ê°œì„ (í•˜ì´ë¸Œë¦¬ë“œ ì„œì¹˜. Re-ranking, Dense ë“±ë“±), Reader ëª¨ë¸ íŒŒì¸íŠœë‹ |
| ìœ¤ì„ ì›… | KorQuAD 1.0 ë°ì´í„° ì¦ê°•, ëª¨ë¸ íŒŒì¸íŠœë‹, Reader ëª¨ë¸ ê°œì„ (CNN layer ì¶”ê°€), Retrieval ëª¨ë¸ êµ¬í˜„(BM25), ì•™ìƒë¸”   |
| ì´ì •ë¯¼ | ë°ì´í„° ì¦ê°• (AEDA, Truncation ë“±), Question ë°ì´í„°ì…‹ íŠœë‹, Korquad ë°ì´í„°ì…‹ íŠœë‹ |
| ì„í•œíƒ | EDA, Retrieval ëª¨ë¸ ê°œì„ (BM25Plus, Re-ranking í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”), Reader ëª¨ë¸ ê°œì„ (PLM ì„ ì • ë° Trainer íŒŒë¼ë¯¸í„° ìµœì í™”)   |

</div>


## ğŸƒ í”„ë¡œì íŠ¸
### ğŸ–¥ï¸ í”„ë¡œì íŠ¸ ê°œìš”
|ê°œìš”| ì„¤ëª… |
|:------:| --- |
| ì£¼ì œ | ê¸°ê³„ ë…í•´ MRC (Machine Reading Comprehension) ì¤‘ â€˜Open-Domain Question Answeringâ€™ ë¥¼ ì£¼ì œë¡œ, ì£¼ì–´ì§„ ì§ˆì˜ì™€ ê´€ë ¨ëœ ë¬¸ì„œë¥¼ íƒìƒ‰í•˜ê³ , í•´ë‹¹ ë¬¸ì„œì—ì„œ ì ì ˆí•œ ë‹µë³€ì„ ì°¾ê±°ë‚˜ ìƒì„±í•˜ëŠ” taskë¥¼ ìˆ˜í–‰ |
| êµ¬ì¡° | Retrieval ë‹¨ê³„ì™€ Reader ë‹¨ê³„ì˜ two-stage êµ¬ì¡° ì‚¬ìš© |
| í‰ê°€ ì§€í‘œ | í‰ê°€ ì§€í‘œë¡œëŠ” EM Score(Exact Match Score)ì´ ì‚¬ìš©ë˜ì—ˆê³ , ëª¨ë¸ì´ ì˜ˆì¸¡í•œ textì™€ ì •ë‹µ textê°€ ê¸€ì ë‹¨ìœ„ë¡œ ì™„ì „íˆ ë˜‘ê°™ì€ ê²½ìš°ì—ë§Œ ì ìˆ˜ ë¶€ì—¬ |
| ê°œë°œ í™˜ê²½ | `GPU` : Tesla V100 Server 4ëŒ€, `IDE` : Vscode, Jupyter Notebook  |
| í˜‘ì—… í™˜ê²½ | Notion(ì§„í–‰ ìƒí™© ê³µìœ ), Github(ì½”ë“œ ë° ë°ì´í„° ê³µìœ ), Slack(ì‹¤ì‹œê°„ ì†Œí†µ), W&B(ì‹œê°í™”, í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹)  |

### ğŸ“… í”„ë¡œì íŠ¸ íƒ€ì„ë¼ì¸
- í”„ë¡œì íŠ¸ëŠ” 2024-09-30 ~ 2024-10-25ê¹Œì§€ ì§„í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.

<div align='center'>


</div>

### ğŸ•µï¸ í”„ë¡œì íŠ¸ ì§„í–‰
- í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ë‹¨ê³„ë³„ë¡œ ì‹¤í—˜í•˜ì—¬ ì ìš©í•œ ë‚´ìš©ë“¤ì„ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.


|  í”„ë¡œì„¸ìŠ¤   | ì„¤ëª… |
|:-----------------:| --- |
| ë°ì´í„° ì²˜ë¦¬  | AEDA, Swap Sentence, Truncation, Mecabì„ í™œìš©í•œ Question ê°•ì¡°, LLMê¸°ë°˜ ì¡°ì‚¬ì œê±° |
| ëª¨ë¸ Finetuning  | Korquad dataset ì¶”ê°€, Korquad1 PLMì— Korquad2 ë°ì´í„°ì…‹ fine-tuning |
| Retriever ëª¨ë¸ ê°œì„  | BM25Plus, DPR, Hybrid Search, Re-rank(2-stage) |
| Reader ëª¨ë¸ ê°œì„  | CNN Layer ì¶”ê°€, Head Customizing, Dropout, Learning rate íŠœë‹ |
| ì•™ìƒë¸” ë°©ë²• | Soft Voting: nbest_predictions.jsonì—ì„œ ì œê³µí•˜ëŠ” ë‹¨ì–´ë³„ í™•ë¥ ê°’ì„ í™œìš©í•´ì„œ, ê° íŒŒì¼ì—ì„œ ë‹¨ì–´ì˜ í™•ë¥ ê°’ì„ í‰ê· ë‚¸ í›„ ê°€ì¥ ë†’ì€ ê°’ì„ ì„ íƒí•˜ëŠ” ë°©ì‹ |


### ğŸ¤– Ensemble Model
| ë²ˆí˜¸ | ëª¨ë¸+ê¸°ë²•                                               | EM(Public) |
|------|--------------------------------------------------------|------------|
| 1    | uomnf97+BM25+CNN                                       | 66.67      |
| 7    | Curtis+CNN+dropout(only_FC_0.05)+BM25Plus            | 66.25      |
| 8    | Curtis+Truncation                                      | 66.25      |
| 9    | HANTAEK_hybrid_optuna_topk20(k1=1.84)                 | 63.15      |
| 10   | HANTAEK_hybrid_optuna_topk20(k1=0.73)                 | 63.75      |
| 11   | HANTAEK_hybrid_optuna_topk10(k1=0.73)                 | 63.75      |
| 12   | uomnf97+BM25                                          | 67.08      |
| 13   | uomnf97+CNN+Re_rank500_20+Cosine                     | 67.08      |
| 14   | curtis+CNN+Re_rank_500_20                             | 65.42      |
| 15   | nlp04_finetuned+CNN+BM25Plus+epoch1_predictions      | 67.5       |


| ìµœì¢…ì œì¶œ | Ensemble                                           | EM(Public) | EM(Private) |
|----------|----------------------------------------------------|------------|--------------|
| O        | ëª¨ë¸ 7,8,9,10,11,12,13 1:1:1:1:1:2:3 ì•™ìƒë¸” + ì¡°ì‚¬ LLM | **77.08**      | 71.11        |
| O        | ëª¨ë¸ 14,8,15,10,11,12,13 1:1:1:1:2:3 ì•™ìƒë¸” + ì¡°ì‚¬ LLM | **77.08**      | 71.67        |
|          | ëª¨ë¸ 1,7,8,9,10,11,12 í‰ê· ì•™ìƒë¸” + ì¡°ì‚¬ LLM        | 76.67      | 71.67        |
|          | ëª¨ë¸ 7,8,9,10,11,12,13 1:1:1:2:2:2 ì•™ìƒë¸” + ì¡°ì‚¬ LLM | 76.67      | 70.83        |
| 1st SOTA | ëª¨ë¸ 15,9,10,11,12,13 1:1:1:1:3:3 ì•™ìƒë¸” + ì¡°ì‚¬ LLM  | 75.42      | **74.17**        |
|          | ëª¨ë¸ 7,8,9,10,11,12,13 1:1:1:1:2:3 ì•™ìƒë¸” + ì¡°ì‚¬ LLM(n=5) | 75.42      | 71.67        |
|          | ëª¨ë¸ 7,8,9,10,11,12,13,14 1:1:1:1:2:2 ì•™ìƒë¸” + ì¡°ì‚¬ LLM | 74.58      | 71.11        |
| 2nd SOTA | ëª¨ë¸ 14,8,9,10,11,12,13 1:1:1:1:2:3 ì•™ìƒë¸” + ì¡°ì‚¬ LLM | 74.58      | **72.22**        |



## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
í”„ë¡œì íŠ¸ í´ë” êµ¬ì¡°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
```
.
â”œâ”€â”€ data
â”‚   â”œâ”€â”€ test_dataset
â”‚   â”œâ”€â”€ train_dataset
â”‚   â””â”€â”€ wikipedia_documents.json
â”œâ”€â”€ models
â”œâ”€â”€ output
â”œâ”€â”€ README.md
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ run.py
â””â”€â”€ src
    â”œâ”€â”€ arguments.py
    â”œâ”€â”€ CNN_layer_model.py
    â”œâ”€â”€ data_analysis.py
    â”œâ”€â”€ ensemble
    â”‚   â”œâ”€â”€ probs_voting_ensemble_n.py
    â”‚   â”œâ”€â”€ probs_voting_ensemble.py
    â”‚   â””â”€â”€ scores_voting_ensemble.py
    â”œâ”€â”€ main.py
    â”œâ”€â”€ optimize_retriever.py
    â”œâ”€â”€ preprocess_answer.ipynb
    â”œâ”€â”€ qa_trainer.py
    â”œâ”€â”€ retrieval_2s_rerank.py
    â”œâ”€â”€ retrieval_BM25.py
    â”œâ”€â”€ retrieval_Dense.py
    â”œâ”€â”€ retrieval_hybridsearch.py
    â”œâ”€â”€ retrieval.py
    â”œâ”€â”€ retrieval_SPLADE.py
    â”œâ”€â”€ retrieval_tfidf.py
    â””â”€â”€ utils.py
```

### ğŸ“¦ src í´ë” êµ¬ì¡° ì„¤ëª…
- TBD


### ğŸ’¾ Installation
- `python=3.10` í™˜ê²½ì—ì„œ requirements.txtë¥¼ pipë¡œ install í•©ë‹ˆë‹¤. (```pip install -r requirements.txt```)
- `python run.py`ë¥¼ ì…ë ¥í•˜ì—¬ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.
